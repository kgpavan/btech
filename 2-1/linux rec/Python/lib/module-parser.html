<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>3.15 parser -- Access Python parse trees</title>
<META NAME="description" CONTENT="3.15 parser -- Access Python parse trees">
<META NAME="keywords" CONTENT="lib">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="lib.css">
<LINK REL="next" href="module-symbol.html">
<LINK REL="previous" href="module-imp.html">
<LINK REL="up" href="python.html">
<LINK REL="next" href="Creating_ASTs.html">
</head>
<body bgcolor="#ffffff">
<div class='navigation'>
<table align='center' width='100%' cellpadding='0' cellspacing='2'>
<tr>
<td><A href="Creating_ASTs.html"><img width=32 height=32 align=bottom border=0 alt="next"
 src="../icons/next.gif"></A></td>
<td><A href="python.html"><img width=32 height=32 align=bottom border=0 alt="up"
 src="../icons/up.gif"></A></td>
<td><A href="examples-imp.html"><img width=32 height=32 align=bottom border=0 alt="previous"
 src="../icons/previous.gif"></A></td>
<td align='center' bgcolor='#99CCFF' width='100%'>
 <b class=title>Python Library Reference</b></td>
<td><A href="contents.html"><img width=32 height=32 align=bottom border=0 alt="contents"
 src="../icons/contents.gif"></A></td>
<td><a
 href='modindex.html'><img width=32 height=32 align=bottom border=0 alt="modules"
 src="../icons/modules.gif"></a></td>
<td><A href="genindex.html"><img width=32 height=32 align=bottom border=0 alt="index"
 src="../icons/index.gif"></A></td>
</tr></table><b class='navlabel'>Next:</b> <span class='sectref'><A href="Creating_ASTs.html">3.15.1 Creating AST Objects</A></span>
<b class='navlabel'>Up:</b> <span class='sectref'><A href="python.html">3. Python Services</A></span>
<b class='navlabel'>Previous:</b> <span class='sectref'><A href="examples-imp.html">3.14.1 Examples</A></span>
<br><hr></div>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION0051500000000000000000">
3.15 <tt class="module">parser</tt> --
         Access Python parse trees</A>
</H1>

<P>


<P>
<a name='l2h-400'></a>

<P>
The <tt class="module">parser</tt> module provides an interface to Python's internal
parser and byte-code compiler.  The primary purpose for this interface
is to allow Python code to edit the parse tree of a Python expression
and create executable code from this.  This is better than trying
to parse and modify an arbitrary Python code fragment as a string
because parsing is performed in a manner identical to the code
forming the application.  It is also faster.

<P>
There are a few things to note about this module which are important
to making use of the data structures created.  This is not a tutorial
on editing the parse trees for Python code, but some examples of using
the <tt class="module">parser</tt> module are presented.

<P>
Most importantly, a good understanding of the Python grammar processed
by the internal parser is required.  For full information on the
language syntax, refer to the <i>Python Language Reference</i>.  The
parser itself is created from a grammar specification defined in the file
<font class="file" face="sans-serif">Grammar/Grammar</font> in the standard Python distribution.  The parse
trees stored in the AST objects created by this module are the
actual output from the internal parser when created by the
<tt class="function">expr()</tt> or <tt class="function">suite()</tt> functions, described below.  The AST
objects created by <tt class="function">sequence2ast()</tt> faithfully simulate those
structures.  Be aware that the values of the sequences which are
considered ``correct'' will vary from one version of Python to another
as the formal grammar for the language is revised.  However,
transporting code from one Python version to another as source text
will always allow correct parse trees to be created in the target
version, with the only restriction being that migrating to an older
version of the interpreter will not support more recent language
constructs.  The parse trees are not typically compatible from one
version to another, whereas source code has always been
forward-compatible.

<P>
Each element of the sequences returned by <tt class="function">ast2list()</tt> or
<tt class="function">ast2tuple()</tt> has a simple form.  Sequences representing
non-terminal elements in the grammar always have a length greater than
one.  The first element is an integer which identifies a production in
the grammar.  These integers are given symbolic names in the C header
file <font class="file" face="sans-serif">Include/graminit.h</font> and the Python module
<tt class='module'><a href='module-symbol.html'>symbol</a></tt>.  Each additional element of the sequence represents
a component of the production as recognized in the input string: these
are always sequences which have the same form as the parent.  An
important aspect of this structure which should be noted is that
keywords used to identify the parent node type, such as the keyword
<tt class="keyword">if</tt> in an <tt class="constant">if_stmt</tt>, are included in the node tree without
any special treatment.  For example, the <tt class="keyword">if</tt> keyword is
represented by the tuple <code>(1, 'if')</code>, where <code>1</code> is the
numeric value associated with all <tt class="constant">NAME</tt> tokens, including
variable and function names defined by the user.  In an alternate form
returned when line number information is requested, the same token
might be represented as <code>(1, 'if', 12)</code>, where the <code>12</code>represents the line number at which the terminal symbol was found.

<P>
Terminal elements are represented in much the same way, but without
any child elements and the addition of the source text which was
identified.  The example of the <tt class="keyword">if</tt> keyword above is
representative.  The various types of terminal symbols are defined in
the C header file <font class="file" face="sans-serif">Include/token.h</font> and the Python module
<tt class='module'><a href='module-token.html'>token</a></tt>.

<P>
The AST objects are not required to support the functionality of this
module, but are provided for three purposes: to allow an application
to amortize the cost of processing complex parse trees, to provide a
parse tree representation which conserves memory space when compared
to the Python list or tuple representation, and to ease the creation
of additional modules in C which manipulate parse trees.  A simple
``wrapper'' class may be created in Python to hide the use of AST
objects.

<P>
The <tt class="module">parser</tt> module defines functions for a few distinct
purposes.  The most important purposes are to create AST objects and
to convert AST objects to other representations such as parse trees
and compiled code objects, but there are also functions which serve to
query the type of parse tree represented by an AST object.

<P>
<div class='seealso'>
  <p class='heading'><b>See Also:</b></p>

  <dl compact class="seemodule">
    <dt>Module <b><tt class='module'><a href='module-symbol.html'>symbol</a></tt>:</b>
    <dd>Useful constants representing internal nodes of
                     the parse tree.
  </dl>
  <dl compact class="seemodule">
    <dt>Module <b><tt class='module'><a href='module-token.html'>token</a></tt>:</b>
    <dd>Useful constants representing leaf nodes of the
                    parse tree and functions for testing node values.
  </dl>
</div>

<P>

<p><hr>
<!--Table of Child-Links-->


<UL>
<LI><A NAME="tex2html1069"
 href="Creating_ASTs.html">3.15.1 Creating AST Objects </A>
<LI><A NAME="tex2html1070"
 href="Converting_ASTs.html">3.15.2 Converting AST Objects </A>
<LI><A NAME="tex2html1071"
 href="Querying_ASTs.html">3.15.3 Queries on AST Objects </A>
<LI><A NAME="tex2html1072"
 href="AST_Errors.html">3.15.4 Exceptions and Error Handling </A>
<LI><A NAME="tex2html1073"
 href="AST_Objects.html">3.15.5 AST Objects </A>
<LI><A NAME="tex2html1074"
 href="AST_Examples.html">3.15.6 Examples </A>
<UL>
<LI><A NAME="tex2html1075"
 href="AST_Examples.html#SECTION0051561000000000000000">3.15.6.1 Emulation of <tt class="function">compile()</tt></A>
<LI><A NAME="tex2html1076"
 href="AST_Examples.html#SECTION0051562000000000000000">3.15.6.2 Information Discovery</A>
</UL></UL>
<!--End of Table of Child-Links-->
<p>
<div class='navigation'><hr><table align='center' width='100%' cellpadding='0' cellspacing='2'>
<tr>
<td><A href="Creating_ASTs.html"><img width=32 height=32 align=bottom border=0 alt="next"
 src="../icons/next.gif"></A></td>
<td><A href="python.html"><img width=32 height=32 align=bottom border=0 alt="up"
 src="../icons/up.gif"></A></td>
<td><A href="examples-imp.html"><img width=32 height=32 align=bottom border=0 alt="previous"
 src="../icons/previous.gif"></A></td>
<td align='center' bgcolor='#99CCFF' width='100%'>
 <b class=title>Python Library Reference</b></td>
<td><A href="contents.html"><img width=32 height=32 align=bottom border=0 alt="contents"
 src="../icons/contents.gif"></A></td>
<td><a
 href='modindex.html'><img width=32 height=32 align=bottom border=0 alt="modules"
 src="../icons/modules.gif"></a></td>
<td><A href="genindex.html"><img width=32 height=32 align=bottom border=0 alt="index"
 src="../icons/index.gif"></A></td>
</tr></table><b class='navlabel'>Next:</b> <span class='sectref'><A href="Creating_ASTs.html">3.15.1 Creating AST Objects</A></span>
<b class='navlabel'>Up:</b> <span class='sectref'><A href="python.html">3. Python Services</A></span>
<b class='navlabel'>Previous:</b> <span class='sectref'><A href="examples-imp.html">3.14.1 Examples</A></span>
</div>
<!--End of Navigation Panel-->
<ADDRESS>
<hr>Send comments on this document to <a href="mailto:python-docs@python.org">python-docs@python.org</a>.
</ADDRESS>
</BODY>
</HTML>
